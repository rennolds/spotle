<script>
  import { browser } from "$app/environment";
  import Help from "./Help.svelte";
  import Guess from "./Guess.svelte";
  import Gameover from "./Gameover.svelte";
  import Countdown from "./Countdown.svelte";
  import Icon from "./Icon.svelte";
  import "./styles.css";
  import artistList from "$lib/artists.json";
  import mysteryArtistList from "$lib/mysteryArtists.json";
  import {
    visited,
    currentGameDate,
    guesses,
    muted,
    gameOver,
  } from "./store.js";

  console.log($gameOver);
  console.log($muted);
  console.log("why empty?");

  function getGenderLabel(code) {
    switch (code) {
      case "m":
        return "Male";
      case "f":
        return "Female";
      case "x":
        return "Mixed";
      case "nb":
        return "Nonbinary";
      default:
        return "Unknown";
    }
  }

  const artists = artistList.map((artist) => ({
    name: artist.artist,
    listener_rank: artist.index,
    image_uri: artist.image_uri,
    genre: artist.genre,
    debut_album_year: artist.debut_album_year,
    country: artist.country.toLowerCase(), // Make country lowercase
    group_size: artist.group_size,
    song_uri: artist.song_uri,
    song_image_uri: artist.song_image_uri,
    embedded_track: artist.embedded_track,
    gender: getGenderLabel(artist.gender),
  }));

  function getLocalMidnightDate() {
    const date = new Date();
    const localTimezoneOffset = date.getTimezoneOffset() / 60; // Convert minutes to hours
    const localMidnight = new Date(date);
    localMidnight.setHours(24 + localTimezoneOffset, 0, 0, 0); // Set to midnight local time
    return localMidnight.toLocaleDateString("en-US");
  }

  let timeUntilMidnightLocal = 0;
  let timer = null;

  function updateTimer() {
    const now = new Date();
    const localMidnight = new Date(now);
    localMidnight.setHours(24, 0, 0, 0); // Set to midnight local time

    if (now > localMidnight) {
      localMidnight.setDate(localMidnight.getDate() + 1); // Increment to next day
    }

    timeUntilMidnightLocal = localMidnight - now;
  }

  function formatTime(milliseconds) {
    const totalSeconds = Math.floor(milliseconds / 1000);
    const hours = Math.floor(totalSeconds / 3600);
    const minutes = Math.floor((totalSeconds % 3600) / 60);
    const seconds = totalSeconds % 60;

    return `${hours.toString().padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
  }

  function startTimer() {
    timer = setInterval(updateTimer, 1000);
  }

  startTimer();

  const todaysDateUnformatted = new Date();
  // Extract day, month, and year from the date object
  const day = String(todaysDateUnformatted.getDate()).padStart(2, "0"); // Add leading zero if necessary
  const month = String(todaysDateUnformatted.getMonth() + 1);
  const year = todaysDateUnformatted.getFullYear();

  // Form the date string in "DD/MM/YYYY" format
  const todaysDate = `${month}/${day}/${year}`;

  let playingGame = false;
  let normalGame = false;
  let createGame = false;
  let splashScreen = true;
  let showHelp = false;
  let searchTerm = "";
  let guessCount = 0;
  let tempGameOver = false;
  let showResults = false;
  let result = "";
  let createGameSelection = null;
  let createNote = "";
  let createShareBtnText = "SHARE";
  let playingChallenge = false;
  let playingRush = false;
  let tempGuesses = [];
  let mysteryArtistEntry;
  let mysteryArtist;
  let spotleNumber = "-1";

  if (browser) {
    const urlParams = new URLSearchParams(window.location.search);
    const encodedArtist = urlParams.get("artist");
    const encodedNote = urlParams.get("note");
    if (encodedArtist) {
      splashScreen = false;
      playingGame = true;
      playingRush = false;
      playingChallenge = true;

      // Decode the Base64 string to Uint8Array
      const artistUint8Array = Uint8Array.from(atob(encodedArtist), (c) =>
        c.charCodeAt(0)
      );
      const noteUint8Array = Uint8Array.from(atob(encodedNote), (c) =>
        c.charCodeAt(0)
      );

      // Convert the Uint8Array to string (UTF-8 representation)
      const decodedArtist = new TextDecoder().decode(artistUint8Array);
      const decodedNote = new TextDecoder().decode(noteUint8Array);

      const selectedArtist = artists.find(
        (artist) => artist.name === decodedArtist
      );
      console.log(selectedArtist);
      if (selectedArtist === undefined) {
        window.location.href = window.location.href.split("?")[0];
        playingChallenge = false;
        splashScreen = true;
        playingGame = false;
      }

      mysteryArtist = selectedArtist;

      mysteryArtistEntry = {
        image_uri: mysteryArtist.image_uri,
        song_uri: mysteryArtist.song_uri,
        artist: mysteryArtist.name,
      };
    }
  }

  const eligibleArtists = [
    "Taylor Swift",
    "Kanye West",
    "Coldplay",
    "Frank Ocean",
    "Daft Punk",
    "The Beatles",
    "blink-182",
    "BTS",
    "Ariana Grande",
  ];

  const artistNames = artistList.map((artist) => artist.artist);

  function fuzzySearch(input) {
    if (input == "") {
      return [];
    }
    input = input.toLowerCase();
    const results = [];

    for (let item of artistNames) {
      const temp_item = item;
      item = item.toLowerCase();

      if (item.startsWith(input)) {
        results.push({ temp_item, score: 1 });
        continue;
      }

      let inputLength = input.length;
      let currentItemLength = item.length;
      let matrix = [];

      // Initialize the matrix with distances
      for (let i = 0; i <= currentItemLength; i++) {
        matrix[i] = [i];
      }
      for (let j = 0; j <= inputLength; j++) {
        matrix[0][j] = j;
      }

      // Fill in the matrix with distances
      for (let i = 1; i <= currentItemLength; i++) {
        for (let j = 1; j <= inputLength; j++) {
          if (item[i - 1] === input[j - 1]) {
            matrix[i][j] = matrix[i - 1][j - 1];
          } else {
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1,
              matrix[i][j - 1] + 1,
              matrix[i - 1][j] + 1
            );
          }
        }
      }

      // Calculate similarity score based on Levenshtein distance
      let maxDistance = Math.max(currentItemLength, inputLength);
      let distance = matrix[currentItemLength][inputLength];
      let similarity = 1 - distance / maxDistance;

      if (similarity >= 0.5) {
        results.push({ temp_item, score: similarity });
      }
    }

    results.sort((a, b) => b.score - a.score);

    return results.slice(0, 10).map((result) => result.temp_item);
  }

  $: filteredArtists = fuzzySearch(searchTerm);

  function playGame() {
    if ($gameOver == true) {
      showResults = true;
    }
    normalGame = true;
    playingGame = true;
    splashScreen = false;
    playingRush = false;
    playingChallenge = false;

    if (normalGame) {
      mysteryArtistEntry = mysteryArtistList.find(
        (entry) => entry.date === todaysDate
      );
      mysteryArtist = artists.find(
        (artist) => artist.name === mysteryArtistEntry.artist
      );
      mysteryArtistList.forEach((entry, index) => {
        // Compare the date property of each object with today's date
        if (entry.date === todaysDate) {
          // If a match is found, store the index
          spotleNumber = index;
          // Exit the loop since we found the match
          return;
        }
      });

      if ($currentGameDate == todaysDate) {
        guessCount = $guesses.length;
        if (guessCount >= 10) {
          result = "L";
        }
        if ($guesses.some((obj) => obj.name === mysteryArtist.name)) {
          result = "W";
        }
      } else {
        $guesses = [];
        $visited = true;
        $gameOver = false;
        $currentGameDate = todaysDate;
        guessCount = 0;
      }
    }
  }

  function handleSearch(artistName) {
    if (filteredArtists.length == 0) {
      return;
    }
    searchTerm = "";

    if (artistName === null) {
      return;
    }

    const selectedArtist = artists.find((artist) => artist.name === artistName);

    if (normalGame) {
      if ($guesses.includes(selectedArtist)) {
        return;
      }

      $guesses.push(selectedArtist);
      $guesses = $guesses;

      if (selectedArtist == mysteryArtist) {
        $gameOver = true;
        showResults = true;
        result = "W";
        return;
      }

      if (guessCount + 1 == 10) {
        $gameOver = true;
        showResults = true;
        result = "L";
        return;
      }

      guessCount++;
      return;
    }

    if (createGame) {
      createGameSelection = selectedArtist;
    }

    if (playingChallenge || playingRush) {
      if (tempGameOver) {
        return;
      }
      if (tempGuesses.includes(selectedArtist)) {
        return;
      }
      tempGuesses.push(selectedArtist);
      tempGuesses = tempGuesses;
      guessCount++;

      if (playingChallenge) {
        if (selectedArtist == mysteryArtist) {
          tempGameOver = true;
          showResults = true;
          result = "W";
          return;
        }

        if (guessCount + 1 == 10) {
          tempGameOver = true;
          showResults = true;
          result = "L";
          return;
        }
      }

      if (playingRush) {
        if (selectedArtist == mysteryArtist) {
          rushIndex++;
          console.log("new artist");
          const selectedArtist = artists.find(
            (artist) => artist.name === eligibleArtists[rushIndex]
          );
          mysteryArtist = selectedArtist;
          mysteryArtistEntry = {
            image_uri: mysteryArtist.image_uri,
            song_uri: mysteryArtist.song_uri,
            artist: mysteryArtist.name,
          };
          tempGuesses = [];
        }
        if (guessCount + 1 == 30) {
          console.log("rush game over");
        }
      }
    }
  }

  function handleOverlayClose() {
    showResults = false;
  }

  function handleMenuClick() {
    if (playingChallenge) {
      window.location.href = window.location.href.split("?")[0];
    }
    playingGame = false;
    normalGame = false;
    playingRush = false;
    createGame = false;
    splashScreen = true;
  }

  function handleMute() {
    if ($muted) {
      $muted = false;
    } else {
      $muted = true;
    }
  }

  function handleCreate() {
    createGame = true;
    playingGame = true;
    splashScreen = false;
  }

  let rushIndex = 0;
  function playRush() {
    splashScreen = false;
    playingGame = true;
    normalGame = false;
    playingChallenge = false;
    playingRush = true;

    for (let i = eligibleArtists.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [eligibleArtists[i], eligibleArtists[j]] = [
        eligibleArtists[j],
        eligibleArtists[i],
      ];
    }
    const selectedArtist = artists.find(
      (artist) => artist.name === eligibleArtists[rushIndex]
    );

    mysteryArtist = selectedArtist;
    mysteryArtistEntry = {
      image_uri: mysteryArtist.image_uri,
      song_uri: mysteryArtist.song_uri,
      artist: mysteryArtist.name,
    };
    tempGuesses = [];
    guessCount = 0;
  }

  function toggleHelp() {
    if (showHelp) {
      showHelp = false;
    } else {
      showHelp = true;
    }
  }

  function handleCreateShare(artist) {
    const artistUint8Array = new TextEncoder().encode(artist.name);
    const noteUint8Array = new TextEncoder().encode(createNote);

    // Encode the Uint8Array to Base64
    const encodedArtistName = btoa(
      String.fromCharCode.apply(null, artistUint8Array)
    );
    const encodedNote = btoa(String.fromCharCode.apply(null, noteUint8Array));

    // Generate the URL with encoded parameters
    const shareURL = `https://spotle.io/?artist=${encodedArtistName}&note=${encodedNote}`;

    const shareText =
      "I made this Spotle for you! Guess the artist in 10 tries.\n\n" +
      shareURL;

    function isMobile() {
      const regex =
        /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
      return regex.test(navigator.userAgent);
    }
    if (isMobile()) {
      if (navigator.share) {
        navigator
          .share({
            text: shareText,
          })
          .then(() => {
            console.log("Thanks for sharing!");
          })
          .catch(console.error);
      } else {
        // congratulations.innerHTML = "Text copied to clipboard.\t";
        createShareBtnText = "COPIED RESULT";
        navigator.clipboard
          .writeText(shareText)
          .then(() => {
            console.log("copied");
          })
          .catch((error) => {
            alert(`Copy failed! ${error}`);
          });
      }
    } else {
      // congratulations.innerHTML = "Text copied to clipboard.\t";
      createShareBtnText = "COPIED RESULT";
      navigator.clipboard.writeText(shareText);
    }
  }
</script>

<body>
  <div class="container">
    {#if showHelp}
      <div class="help">
        <Help on:close={toggleHelp}></Help>
      </div>
    {/if}
    <div class="header">
      {#if playingGame}
        <div class="left">
          <button on:click={handleMenuClick}>
            <Icon width={"1.75rem"} height={"1.75rem"} name={"menu"}></Icon>
          </button>
        </div>
      {/if}

      <div class="logo {playingGame ? 'smaller-svg' : ''}">
        <svg
          width="274"
          height="64"
          viewBox="0 0 274 64"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3.39588 33.1289H-0.000237286V25.3396H3.39588V33.1289ZM10.0882 23.059H6.69207V35.4095H10.0882V23.059ZM16.6681 16.6707H13.272V41.7978H16.6681V16.6707ZM22.9232 11.7413H19.5271V46.4973H22.9232V11.7496V11.7413ZM29.6198 20.229H26.2237V38.2396L29.6198 38.2396V20.229ZM36.4226 6.60078H33.0264L33.0264 52.6385H36.4333L36.4333 6.60078H36.4226ZM43.117 -5.43778e-05H39.7209L39.7209 58.4686H43.117L43.117 -5.43778e-05ZM49.697 9.0265L46.3008 9.0265L46.3008 49.4422H49.697L49.697 9.02631V9.0265ZM56.504 20.5037H53.1078V37.5392H56.504V20.5037ZM63.0837 24.5648H59.6876V33.9188H63.0837V24.5494V24.5648ZM69.6637 19.5604H66.2675V38.9147H69.6637V19.5542V19.5604ZM76.1375 10.1914H72.7414V49.3847H76.1373V10.1846L76.1375 10.1914ZM82.7172 16.1791H79.3211V42.6261H82.7172V16.1724V16.1791ZM89.4224 23.059H86.0262V35.4095H89.4224V23.059Z"
            fill="#BA81C2"
            fill-opacity="0.7"
          />
          <path
            d="M178.315 25.3397H181.711V33.129H178.315V25.3397ZM171.623 35.4096H175.019V23.059H171.623V35.4096ZM165.043 41.7979H168.439V16.6708H165.043V41.7979ZM158.788 46.7273H162.184V11.9712H158.788V46.7189V46.7273ZM152.091 38.2396H155.487V20.229H152.091V38.2396ZM145.288 51.8678H148.684V5.83009H145.278V51.8678H145.288ZM138.594 58.4686H141.99V0L138.594 0V58.4686ZM132.014 49.4421H135.41V9.02636H132.014V49.4423V49.4421ZM125.207 37.9648H128.603V20.9293H125.207V37.9648ZM118.627 33.9038H122.023V24.5498H118.627V33.9192V33.9038ZM112.047 38.9082H115.443V19.5538H112.047V38.9144V38.9082ZM105.573 48.2772H108.97V9.08389H105.574V48.284L105.573 48.2772ZM98.9937 42.2895H102.39V15.8425H98.9937V42.2961V42.2895ZM92.2886 35.4096H95.6847V23.059H92.2886V35.4096Z"
            fill="#BA81C2"
            fill-opacity="0.7"
          />
          <path
            d="M187.974 33.129H184.577V25.3397H187.974V33.129ZM194.666 23.059H191.27V35.4096H194.666V23.059ZM201.246 16.6708H197.85V41.7979H201.246V16.6708ZM207.501 11.7413H204.105V46.4974H207.501V11.7497V11.7413ZM214.197 20.229H210.801V38.2396L214.197 38.2396V20.229ZM221 6.60084H217.604V52.6385H221.011V6.60084H221ZM227.695 6.65731e-06H224.299V58.4686H227.695V6.65731e-06ZM234.275 9.02656L230.878 9.02656V49.4423H234.275V9.02637V9.02656ZM241.082 20.5038H237.685V37.5393H241.082V20.5038ZM247.661 24.5648H244.265V33.9188H247.661V24.5494V24.5648ZM254.241 19.5605H250.845V38.9148H254.241V19.5542V19.5605ZM260.715 10.1914H257.319V49.3847H260.715V10.1846L260.715 10.1914ZM267.295 16.1791H263.899V42.6261H267.295V16.1725V16.1791ZM274 23.059H270.604V35.4096H274V23.059Z"
            fill="#BA81C2"
            fill-opacity="0.7"
          />
          <path
            d="M60.3766 11.2718C61.735 12.272 62.5038 13.6752 62.6829 15.4814H71.9754C71.9306 12.7497 71.1991 10.3463 69.781 8.27138C68.3629 6.19644 66.3775 4.57679 63.8249 3.41243C61.2872 2.24807 58.3166 1.66589 54.913 1.66589C51.5693 1.66589 48.5837 2.24807 45.9565 3.41243C43.3292 4.57679 41.2617 6.19644 39.754 8.27138C38.2613 10.3463 37.5223 12.7721 37.5373 15.5486C37.5223 18.9372 38.6344 21.6316 40.8736 23.6319C43.1127 25.6322 46.1654 27.1026 50.0317 28.0431L55.025 29.297C56.6969 29.7 58.1076 30.1479 59.257 30.6405C60.4214 31.1331 61.3021 31.7302 61.8992 32.4318C62.5112 33.1334 62.8172 33.9992 62.8172 35.0292C62.8172 36.1338 62.4814 37.1116 61.8096 37.9625C61.1379 38.8134 60.19 39.4776 58.9659 39.9553C57.7568 40.433 56.3312 40.6718 54.6891 40.6718C53.0172 40.6718 51.517 40.4181 50.1884 39.9105C48.8748 39.3881 47.8224 38.6193 47.0312 37.6042C46.255 36.5742 45.8146 35.2904 45.7102 33.7529H36.3281C36.4028 37.0519 37.2014 39.821 38.724 42.0601C40.2616 44.2843 42.3962 45.9637 45.128 47.0982C47.8747 48.2327 51.099 48.8 54.8011 48.8C58.533 48.8 61.7201 48.2402 64.3623 47.1206C67.0194 45.9861 69.0495 44.3963 70.4527 42.3512C71.8709 40.2912 72.5874 37.858 72.6023 35.0516C72.5874 33.1408 72.2366 31.4466 71.5499 29.9687C70.8782 28.4909 69.9303 27.2071 68.7062 26.1174C67.4821 25.0277 66.0341 24.1096 64.3623 23.3632C62.6904 22.6169 60.8543 22.0197 58.8539 21.5719L54.7339 20.5867C53.7338 20.3628 52.7933 20.0941 51.9126 19.7806C51.0319 19.4522 50.2556 19.0715 49.5839 18.6386C48.9121 18.1908 48.3822 17.6609 47.9941 17.0488C47.6209 16.4368 47.4492 15.7203 47.4791 14.8993C47.4791 13.914 47.7627 13.0333 48.33 12.2571C48.9121 11.4808 49.7481 10.8763 50.8378 10.4434C51.9275 9.99552 53.2635 9.77161 54.8459 9.77161C57.1746 9.77161 59.0182 10.2717 60.3766 11.2718Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M78.9447 13.7573V61.0481H88.4835V42.6423H88.7746C89.2075 43.5977 89.8344 44.5456 90.6554 45.486C91.4765 46.4115 92.5289 47.1803 93.8126 47.7923C95.1113 48.4044 96.6862 48.7104 98.5372 48.7104C101.15 48.7104 103.508 48.0386 105.613 46.6952C107.733 45.3367 109.405 43.3439 110.629 40.7166C111.868 38.0744 112.487 34.8351 112.487 30.9987C112.487 27.0578 111.853 23.7812 110.584 21.1689C109.315 18.5416 107.621 16.5786 105.501 15.2799C103.381 13.9663 101.067 13.3095 98.5596 13.3095C96.634 13.3095 95.0218 13.6379 93.7231 14.2947C92.4393 14.9366 91.3944 15.7427 90.5883 16.713C89.7971 17.6683 89.1925 18.6088 88.7746 19.5343H88.3491V13.7573H78.9447ZM89.1328 36.3055C88.5656 34.7829 88.2819 32.999 88.2819 30.9539C88.2819 28.9089 88.5656 27.1325 89.1328 25.6248C89.7001 24.1171 90.5136 22.9527 91.5735 22.1317C92.6483 21.3107 93.9619 20.9002 95.5144 20.9002C97.0818 20.9002 98.4029 21.3256 99.4777 22.1765C100.552 23.0274 101.366 24.2066 101.918 25.7143C102.471 27.222 102.747 28.9686 102.747 30.9539C102.747 32.9543 102.463 34.7232 101.896 36.2607C101.344 37.7833 100.53 38.9776 99.4553 39.8434C98.3805 40.6942 97.0669 41.1197 95.5144 41.1197C93.9768 41.1197 92.6707 40.7017 91.5959 39.8658C90.5211 39.0149 89.7001 37.8281 89.1328 36.3055Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M125.362 46.6056C127.9 48.0834 130.908 48.8223 134.386 48.8223C137.864 48.8223 140.865 48.0834 143.387 46.6056C145.925 45.1128 147.881 43.0379 149.254 40.3808C150.627 37.7087 151.314 34.6112 151.314 31.0883C151.314 27.5355 150.627 24.4306 149.254 21.7734C147.881 19.1014 145.925 17.0264 143.387 15.5486C140.865 14.0558 137.864 13.3095 134.386 13.3095C130.908 13.3095 127.9 14.0558 125.362 15.5486C122.839 17.0264 120.891 19.1014 119.518 21.7734C118.145 24.4306 117.458 27.5355 117.458 31.0883C117.458 34.6112 118.145 37.7087 119.518 40.3808C120.891 43.0379 122.839 45.1128 125.362 46.6056ZM138.394 40.0897C137.334 40.9853 136.013 41.4332 134.431 41.4332C132.834 41.4332 131.49 40.9853 130.4 40.0897C129.326 39.1791 128.512 37.9401 127.96 36.3727C127.422 34.8053 127.154 33.0214 127.154 31.0211C127.154 29.0208 127.422 27.237 127.96 25.6696C128.512 24.1022 129.326 22.8632 130.4 21.9526C131.49 21.042 132.834 20.5867 134.431 20.5867C136.013 20.5867 137.334 21.042 138.394 21.9526C139.454 22.8632 140.253 24.1022 140.79 25.6696C141.342 27.237 141.618 29.0208 141.618 31.0211C141.618 33.0214 141.342 34.8053 140.79 36.3727C140.253 37.9401 139.454 39.1791 138.394 40.0897Z"
            fill="white"
          />
          <path
            d="M175.81 20.9226V13.7573H169.339V5.51723H159.8V13.7573H155.098V20.9226H159.8V38.8357C159.785 41.0898 160.256 42.9558 161.211 44.4336C162.166 45.9115 163.502 47.0012 165.219 47.7028C166.951 48.4044 168.966 48.7104 171.265 48.6208C172.504 48.576 173.556 48.4492 174.422 48.2402C175.288 48.0461 175.959 47.8744 176.437 47.7252L174.937 40.6271C174.698 40.6718 174.355 40.739 173.907 40.8286C173.459 40.9032 173.011 40.9405 172.563 40.9405C171.922 40.9405 171.354 40.8435 170.862 40.6495C170.384 40.4554 170.011 40.1195 169.742 39.6418C169.473 39.1492 169.339 38.4626 169.339 37.5818V20.9226H175.81Z"
            fill="white"
          />
          <path
            d="M192.302 48.1506V2.29286H182.763V48.1506H192.302Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M206.481 46.6728C209.034 48.1058 212.079 48.8223 215.617 48.8223C218.453 48.8223 220.953 48.3894 223.118 47.5236C225.297 46.6429 227.074 45.4188 228.447 43.8514C229.835 42.2691 230.753 40.4181 231.201 38.2984L222.379 37.7162C222.05 38.582 221.573 39.3134 220.946 39.9105C220.319 40.5076 219.565 40.9555 218.684 41.254C217.804 41.5526 216.833 41.7019 215.773 41.7019C214.176 41.7019 212.795 41.366 211.631 40.6942C210.467 40.0225 209.563 39.0671 208.922 37.8281C208.295 36.5891 207.981 35.1188 207.981 33.417V33.3946H231.403V30.7748C231.403 27.849 230.992 25.2964 230.171 23.1169C229.35 20.9226 228.201 19.1014 226.723 17.6534C225.26 16.2054 223.543 15.1232 221.573 14.4066C219.617 13.6752 217.505 13.3095 215.236 13.3095C211.862 13.3095 208.922 14.0558 206.414 15.5486C203.921 17.0414 201.988 19.1238 200.614 21.7958C199.241 24.4679 198.554 27.5728 198.554 31.1107C198.554 34.7381 199.241 37.8804 200.614 40.5375C201.988 43.1797 203.943 45.2248 206.481 46.6728ZM207.99 27.4833C208.048 26.2482 208.366 25.1212 208.944 24.1022C209.571 22.9826 210.437 22.0944 211.541 21.4376C212.661 20.7658 213.945 20.43 215.393 20.43C216.781 20.43 217.998 20.736 219.043 21.348C220.102 21.9451 220.931 22.7736 221.528 23.8335C222.125 24.8933 222.424 26.1099 222.424 27.4833H207.99Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M108.601 60.9585C108.913 61.0969 109.269 61.1662 109.668 61.1662C109.977 61.1662 110.25 61.1254 110.486 61.044C110.722 60.9599 110.925 60.8445 111.093 60.698C111.261 60.5487 111.395 60.3763 111.496 60.1809H111.545V61.0481H113.19V56.8303C113.19 56.4585 113.118 56.1396 112.974 55.8736C112.83 55.6049 112.633 55.3851 112.383 55.2141C112.136 55.0431 111.853 54.9169 111.533 54.8355C111.215 54.7541 110.883 54.7133 110.535 54.7133C110.036 54.7133 109.596 54.7893 109.216 54.9413C108.839 55.0906 108.531 55.305 108.292 55.5846C108.053 55.8614 107.893 56.1898 107.811 56.5698L109.416 56.7001C109.475 56.4938 109.597 56.3228 109.782 56.1871C109.966 56.0487 110.215 55.9795 110.527 55.9795C110.823 55.9795 111.051 56.05 111.211 56.1912C111.374 56.3323 111.455 56.5318 111.455 56.7896V56.8141C111.455 56.9471 111.405 57.0475 111.305 57.1153C111.204 57.1832 111.043 57.2348 110.82 57.27C110.598 57.3026 110.304 57.3379 109.941 57.3759C109.631 57.4057 109.335 57.4573 109.053 57.5306C108.774 57.6039 108.524 57.7124 108.304 57.8563C108.084 58.0001 107.911 58.1901 107.783 58.4263C107.655 58.6624 107.592 58.9541 107.592 59.3016C107.592 59.7141 107.681 60.0588 107.86 60.3356C108.042 60.6098 108.289 60.8174 108.601 60.9585ZM110.84 59.8186C110.645 59.919 110.42 59.9692 110.165 59.9692C109.899 59.9692 109.679 59.9082 109.505 59.786C109.334 59.6612 109.249 59.4807 109.249 59.2446C109.249 59.0817 109.291 58.946 109.375 58.8374C109.459 58.7262 109.577 58.638 109.729 58.5728C109.881 58.5077 110.059 58.4602 110.262 58.4303C110.357 58.4168 110.463 58.4018 110.58 58.3855C110.697 58.3665 110.813 58.3462 110.93 58.3245C111.047 58.3 111.151 58.2743 111.243 58.2471C111.338 58.2173 111.413 58.1847 111.467 58.1494V58.813C111.467 59.0329 111.412 59.2296 111.3 59.4033C111.189 59.577 111.036 59.7155 110.84 59.8186Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M118.56 63.2913C118.962 63.446 119.444 63.5234 120.006 63.5234C120.603 63.5234 121.131 63.4324 121.589 63.2506C122.051 63.0715 122.412 62.8028 122.672 62.4445C122.933 62.0862 123.063 61.6411 123.063 61.1092V54.7948H121.341V55.8451H121.276C121.197 55.6769 121.085 55.5059 120.938 55.3322C120.794 55.1557 120.604 55.0092 120.368 54.8925C120.132 54.773 119.839 54.7133 119.489 54.7133C119.03 54.7133 118.608 54.8314 118.223 55.0675C117.84 55.3037 117.533 55.6592 117.302 56.1342C117.072 56.6091 116.956 57.2008 116.956 57.9092C116.956 58.6013 117.069 59.174 117.294 59.6272C117.522 60.0778 117.828 60.413 118.21 60.6328C118.596 60.85 119.023 60.9585 119.493 60.9585C119.824 60.9585 120.109 60.9097 120.348 60.812C120.586 60.7143 120.782 60.588 120.934 60.4333C121.086 60.2786 121.2 60.1144 121.276 59.9407H121.349V61.0847C121.349 61.5136 121.226 61.8189 120.979 62.0007C120.734 62.1853 120.424 62.2776 120.046 62.2776C119.794 62.2776 119.58 62.2437 119.403 62.1758C119.229 62.1107 119.09 62.0238 118.984 61.9153C118.878 61.8067 118.801 61.69 118.752 61.5651L117.148 61.7809C117.218 62.1093 117.372 62.4051 117.608 62.6684C117.844 62.9317 118.161 63.1393 118.56 63.2913ZM120.751 59.4481C120.558 59.5865 120.322 59.6557 120.042 59.6557C119.757 59.6557 119.517 59.5852 119.322 59.444C119.129 59.3002 118.981 59.098 118.878 58.8374C118.778 58.5742 118.727 58.262 118.727 57.9011C118.727 57.5455 118.778 57.232 118.878 56.9606C118.978 56.6892 119.126 56.4775 119.322 56.3255C119.517 56.1708 119.757 56.0935 120.042 56.0935C120.322 56.0935 120.559 56.1681 120.755 56.3174C120.95 56.4667 121.099 56.677 121.203 56.9484C121.306 57.2171 121.357 57.5347 121.357 57.9011C121.357 58.2675 121.304 58.5823 121.199 58.8456C121.095 59.1061 120.946 59.307 120.751 59.4481Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M125.16 60.9585C125.472 61.0969 125.827 61.1662 126.226 61.1662C126.536 61.1662 126.809 61.1254 127.045 61.044C127.281 60.9599 127.483 60.8445 127.651 60.698C127.82 60.5487 127.954 60.3763 128.054 60.1809H128.103V61.0481H129.748V56.8303C129.748 56.4585 129.676 56.1396 129.532 55.8736C129.388 55.6049 129.192 55.3851 128.942 55.2141C128.695 55.0431 128.411 54.9169 128.091 54.8355C127.773 54.7541 127.441 54.7133 127.094 54.7133C126.594 54.7133 126.155 54.7893 125.775 54.9413C125.397 55.0906 125.089 55.305 124.85 55.5846C124.612 55.8614 124.451 56.1898 124.37 56.5698L125.974 56.7001C126.034 56.4938 126.156 56.3228 126.34 56.1871C126.525 56.0487 126.773 55.9795 127.085 55.9795C127.381 55.9795 127.609 56.05 127.769 56.1912C127.932 56.3323 128.014 56.5318 128.014 56.7896V56.8141C128.014 56.9471 127.963 57.0475 127.863 57.1153C127.763 57.1832 127.601 57.2348 127.379 57.27C127.156 57.3026 126.863 57.3379 126.499 57.3759C126.19 57.4057 125.894 57.4573 125.612 57.5306C125.332 57.6039 125.082 57.7124 124.863 57.8563C124.643 58.0001 124.469 58.1901 124.341 58.4263C124.214 58.6624 124.15 58.9541 124.15 59.3016C124.15 59.7141 124.24 60.0588 124.419 60.3356C124.601 60.6098 124.848 60.8174 125.16 60.9585ZM127.399 59.8186C127.204 59.919 126.978 59.9692 126.723 59.9692C126.457 59.9692 126.237 59.9082 126.064 59.786C125.893 59.6612 125.807 59.4807 125.807 59.2446C125.807 59.0817 125.849 58.946 125.933 58.8374C126.017 58.7262 126.136 58.638 126.288 58.5728C126.439 58.5077 126.617 58.4602 126.821 58.4303C126.916 58.4168 127.022 58.4018 127.138 58.3855C127.255 58.3665 127.372 58.3462 127.488 58.3245C127.605 58.3 127.71 58.2743 127.802 58.2471C127.897 58.2173 127.972 58.1847 128.026 58.1494V58.813C128.026 59.0329 127.97 59.2296 127.859 59.4033C127.748 59.577 127.594 59.7155 127.399 59.8186Z"
            fill="white"
          />
          <path
            d="M131.094 54.7948V61.0481H132.828V57.2945C132.828 57.0638 132.873 56.8629 132.962 56.6919C133.052 56.5182 133.173 56.3839 133.325 56.2889C133.479 56.1912 133.653 56.1423 133.846 56.1423C134.131 56.1423 134.36 56.2332 134.534 56.4151C134.71 56.5969 134.798 56.8412 134.798 57.1479V61.0481H136.48V57.2293C136.48 56.9036 136.568 56.6417 136.744 56.4436C136.921 56.2427 137.166 56.1423 137.481 56.1423C137.758 56.1423 137.989 56.2292 138.173 56.4029C138.358 56.5766 138.45 56.8371 138.45 57.1845V61.0481H140.18V56.8426C140.18 56.164 139.997 55.6402 139.631 55.2711C139.267 54.8993 138.793 54.7133 138.21 54.7133C137.751 54.7133 137.354 54.8219 137.017 55.039C136.683 55.2534 136.453 55.5398 136.325 55.8981H136.26C136.159 55.5344 135.959 55.2467 135.657 55.035C135.356 54.8205 134.991 54.7133 134.562 54.7133C134.139 54.7133 133.775 54.8192 133.471 55.0309C133.167 55.2426 132.95 55.5316 132.82 55.8981H132.746V54.7948H131.094Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M142.739 60.7794C143.203 61.0399 143.757 61.1702 144.4 61.1702C144.916 61.1702 145.37 61.0915 145.764 60.9341C146.16 60.774 146.483 60.5514 146.733 60.2664C146.985 59.9787 147.152 59.6422 147.234 59.2568L145.63 59.1509C145.57 59.3083 145.483 59.4413 145.369 59.5499C145.255 59.6585 145.118 59.7399 144.958 59.7942C144.798 59.8484 144.621 59.8756 144.429 59.8756C144.138 59.8756 143.887 59.8145 143.676 59.6924C143.464 59.5703 143.3 59.3965 143.183 59.1713C143.069 58.946 143.012 58.6787 143.012 58.3693V58.3652H147.27V57.8889C147.27 57.3569 147.196 56.8928 147.046 56.4965C146.897 56.0975 146.688 55.7664 146.419 55.5031C146.153 55.2399 145.841 55.0431 145.483 54.9128C145.128 54.7798 144.744 54.7133 144.331 54.7133C143.718 54.7133 143.183 54.849 142.727 55.1205C142.274 55.3919 141.922 55.7705 141.672 56.2563C141.423 56.7421 141.298 57.3067 141.298 57.9499C141.298 58.6095 141.423 59.1808 141.672 59.6639C141.922 60.1443 142.278 60.5161 142.739 60.7794ZM143.014 57.2904C143.024 57.0658 143.082 56.8609 143.187 56.6756C143.301 56.4721 143.458 56.3106 143.659 56.1912C143.863 56.069 144.096 56.008 144.359 56.008C144.612 56.008 144.833 56.0636 145.023 56.1749C145.216 56.2835 145.366 56.4341 145.475 56.6268C145.584 56.8195 145.638 57.0407 145.638 57.2904H143.014Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M151.088 52.7103V61.0481H152.798V60.0466H152.875C152.954 60.2203 153.068 60.3926 153.217 60.5636C153.367 60.7319 153.558 60.8717 153.791 60.9829C154.027 61.0942 154.314 61.1499 154.65 61.1499C155.125 61.1499 155.554 61.0277 155.937 60.7835C156.322 60.5365 156.626 60.1741 156.849 59.6965C157.074 59.2161 157.187 58.6271 157.187 57.9296C157.187 57.213 157.071 56.6173 156.841 56.1423C156.61 55.6646 156.302 55.3077 155.917 55.0716C155.531 54.8328 155.11 54.7133 154.654 54.7133C154.304 54.7133 154.011 54.773 153.775 54.8925C153.542 55.0092 153.352 55.1557 153.205 55.3322C153.061 55.5059 152.951 55.6769 152.875 55.8451H152.822V52.7103H151.088ZM152.94 58.8944C152.837 58.6176 152.786 58.2933 152.786 57.9214C152.786 57.5496 152.837 57.2266 152.94 56.9525C153.044 56.6784 153.192 56.4667 153.384 56.3174C153.58 56.1681 153.818 56.0935 154.101 56.0935C154.386 56.0935 154.626 56.1708 154.821 56.3255C155.017 56.4802 155.165 56.6946 155.265 56.9688C155.366 57.2429 155.416 57.5604 155.416 57.9214C155.416 58.2851 155.364 58.6067 155.261 58.8863C155.161 59.1631 155.013 59.3803 154.817 59.5377C154.622 59.6924 154.383 59.7697 154.101 59.7697C153.821 59.7697 153.584 59.6937 153.388 59.5418C153.193 59.387 153.044 59.1713 152.94 58.8944Z"
            fill="white"
          />
          <path
            d="M158.594 63.3402C158.787 63.3754 158.993 63.3931 159.213 63.3931C159.642 63.3931 160.008 63.3239 160.312 63.1855C160.616 63.0498 160.867 62.8557 161.066 62.6033C161.266 62.3536 161.425 62.0605 161.542 61.7239L163.972 54.7948H162.136L160.829 59.387H160.764L159.47 54.7948H157.646L159.889 61.2272L159.787 61.4918C159.711 61.6873 159.612 61.8257 159.49 61.9071C159.371 61.9885 159.228 62.0265 159.063 62.0211C158.9 62.0157 158.716 61.9817 158.513 61.9193L158.122 63.214C158.247 63.2655 158.404 63.3076 158.594 63.3402Z"
            fill="white"
          />
          <path
            d="M170.876 56.0975V54.7948H169.63V54.3754C169.63 54.1637 169.68 53.9995 169.781 53.8828C169.881 53.7634 170.059 53.7037 170.314 53.7037C170.417 53.7037 170.518 53.7132 170.615 53.7322C170.716 53.7512 170.8 53.7715 170.868 53.7933L171.177 52.4905C171.069 52.4579 170.903 52.4213 170.681 52.3806C170.461 52.3398 170.218 52.3195 169.952 52.3195C169.558 52.3195 169.207 52.3941 168.897 52.5434C168.588 52.6927 168.344 52.9166 168.165 53.2151C167.988 53.5137 167.9 53.8896 167.9 54.3429V54.7948H167.017V56.0975H167.9V61.0481H169.63V56.0975H170.876Z"
            fill="white"
          />
          <path
            d="M173.67 61.0481V52.7103H171.936V61.0481H173.67Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M175.776 60.9585C176.088 61.0969 176.443 61.1662 176.842 61.1662C177.152 61.1662 177.425 61.1254 177.661 61.044C177.897 60.9599 178.099 60.8445 178.267 60.698C178.436 60.5487 178.57 60.3763 178.67 60.1809H178.719V61.0481H180.364V56.8303C180.364 56.4585 180.292 56.1396 180.148 55.8736C180.004 55.6049 179.808 55.3851 179.558 55.2141C179.311 55.0431 179.027 54.9169 178.707 54.8355C178.389 54.7541 178.057 54.7133 177.71 54.7133C177.21 54.7133 176.77 54.7893 176.39 54.9413C176.013 55.0906 175.705 55.305 175.466 55.5846C175.227 55.8614 175.067 56.1898 174.986 56.5698L176.59 56.7001C176.65 56.4938 176.772 56.3228 176.956 56.1871C177.141 56.0487 177.389 55.9795 177.701 55.9795C177.997 55.9795 178.225 56.05 178.385 56.1912C178.548 56.3323 178.63 56.5318 178.63 56.7896V56.8141C178.63 56.9471 178.579 57.0475 178.479 57.1153C178.379 57.1832 178.217 57.2348 177.995 57.27C177.772 57.3026 177.479 57.3379 177.115 57.3759C176.806 57.4057 176.51 57.4573 176.228 57.5306C175.948 57.6039 175.698 57.7124 175.479 57.8563C175.259 58.0001 175.085 58.1901 174.957 58.4263C174.83 58.6624 174.766 58.9541 174.766 59.3016C174.766 59.7141 174.856 60.0588 175.035 60.3356C175.217 60.6098 175.464 60.8174 175.776 60.9585ZM178.015 59.8186C177.819 59.919 177.594 59.9692 177.339 59.9692C177.073 59.9692 176.853 59.9082 176.68 59.786C176.509 59.6612 176.423 59.4807 176.423 59.2446C176.423 59.0817 176.465 58.946 176.549 58.8374C176.633 58.7262 176.751 58.638 176.903 58.5728C177.055 58.5077 177.233 58.4602 177.437 58.4303C177.532 58.4168 177.638 58.4018 177.754 58.3855C177.871 58.3665 177.988 58.3462 178.104 58.3245C178.221 58.3 178.326 58.2743 178.418 58.2471C178.513 58.2173 178.588 58.1847 178.642 58.1494V58.813C178.642 59.0329 178.586 59.2296 178.475 59.4033C178.364 59.577 178.21 59.7155 178.015 59.8186Z"
            fill="white"
          />
          <path
            d="M185.036 56.0975V54.7948H183.859V53.2966H182.125V54.7948H181.27V56.0975H182.125V59.3545C182.122 59.7643 182.207 60.1036 182.381 60.3723C182.555 60.641 182.798 60.8391 183.11 60.9667C183.425 61.0942 183.791 61.1499 184.209 61.1336C184.434 61.1254 184.626 61.1024 184.783 61.0644C184.941 61.0291 185.063 60.9979 185.15 60.9707L184.877 59.6802C184.833 59.6883 184.771 59.7005 184.69 59.7168C184.608 59.7304 184.527 59.7372 184.445 59.7372C184.329 59.7372 184.225 59.7195 184.136 59.6842C184.049 59.649 183.981 59.5879 183.932 59.501C183.883 59.4115 183.859 59.2866 183.859 59.1265V56.0975H185.036Z"
            fill="white"
          />
          <path
            d="M187.452 54.7948H185.697L187.399 61.0481H189.231L190.306 57.1153H190.383L191.458 61.0481H193.294L194.992 54.7948H193.241L192.288 58.9718H192.235L191.21 54.7948H189.487L188.478 58.9962H188.421L187.452 54.7948Z"
            fill="white"
          />
          <path
            d="M197.651 61.0481V57.4329C197.654 57.1642 197.705 56.9348 197.806 56.7449C197.909 56.5522 198.05 56.4056 198.229 56.3052C198.411 56.2047 198.62 56.1545 198.856 56.1545C199.209 56.1545 199.483 56.2617 199.679 56.4762C199.877 56.6906 199.974 56.9905 199.972 57.3759V61.0481H201.706V57.0665C201.709 56.5779 201.619 56.1586 201.437 55.8085C201.258 55.4556 201.006 55.1856 200.68 54.9983C200.357 54.8083 199.979 54.7133 199.544 54.7133C199.069 54.7133 198.674 54.8192 198.36 55.0309C198.045 55.2399 197.817 55.5289 197.676 55.8981H197.602V52.7103H195.917V61.0481H197.651Z"
            fill="white"
          />
          <path
            d="M204.805 54.7948H203.071V61.0481H204.805V54.7948Z"
            fill="white"
          />
          <path
            d="M203.279 53.7322C203.463 53.9032 203.684 53.9887 203.942 53.9887C204.2 53.9887 204.42 53.9032 204.602 53.7322C204.786 53.5585 204.879 53.3508 204.879 53.1093C204.879 52.8705 204.786 52.6655 204.602 52.4945C204.42 52.3208 204.2 52.234 203.942 52.234C203.684 52.234 203.463 52.3208 203.279 52.4945C203.097 52.6655 203.006 52.8705 203.006 53.1093C203.006 53.3508 203.097 53.5585 203.279 53.7322Z"
            fill="white"
          />
          <path
            d="M209.521 56.0975V54.7948H208.344V53.2966H206.61V54.7948H205.755V56.0975H206.61V59.3545C206.607 59.7643 206.693 60.1036 206.866 60.3723C207.04 60.641 207.283 60.8391 207.595 60.9667C207.91 61.0942 208.276 61.1499 208.694 61.1336C208.92 61.1254 209.111 61.1024 209.268 61.0644C209.426 61.0291 209.548 60.9979 209.635 60.9707L209.362 59.6802C209.318 59.6883 209.256 59.7005 209.175 59.7168C209.093 59.7304 209.012 59.7372 208.93 59.7372C208.814 59.7372 208.711 59.7195 208.621 59.6842C208.534 59.649 208.466 59.5879 208.417 59.501C208.369 59.4115 208.344 59.2866 208.344 59.1265V56.0975H209.521Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M211.772 60.7794C212.236 61.0399 212.79 61.1702 213.433 61.1702C213.949 61.1702 214.403 61.0915 214.797 60.9341C215.193 60.774 215.516 60.5514 215.766 60.2664C216.018 59.9787 216.185 59.6422 216.267 59.2568L214.663 59.1509C214.603 59.3083 214.516 59.4413 214.402 59.5499C214.288 59.6585 214.151 59.7399 213.991 59.7942C213.831 59.8484 213.654 59.8756 213.462 59.8756C213.171 59.8756 212.92 59.8145 212.708 59.6924C212.497 59.5703 212.333 59.3965 212.216 59.1713C212.102 58.946 212.045 58.6787 212.045 58.3693V58.3652H216.303V57.8889C216.303 57.3569 216.229 56.8928 216.079 56.4965C215.93 56.0975 215.721 55.7664 215.452 55.5031C215.186 55.2399 214.874 55.0431 214.516 54.9128C214.16 54.7798 213.776 54.7133 213.364 54.7133C212.75 54.7133 212.216 54.849 211.76 55.1205C211.307 55.3919 210.955 55.7705 210.705 56.2563C210.456 56.7421 210.331 57.3067 210.331 57.9499C210.331 58.6095 210.456 59.1808 210.705 59.6639C210.955 60.1443 211.311 60.5161 211.772 60.7794ZM212.046 57.2904C212.057 57.0658 212.115 56.8609 212.22 56.6756C212.334 56.4721 212.491 56.3106 212.692 56.1912C212.896 56.069 213.129 56.008 213.392 56.008C213.645 56.008 213.866 56.0636 214.056 56.1749C214.249 56.2835 214.399 56.4341 214.508 56.6268C214.616 56.8195 214.671 57.0407 214.671 57.2904H212.046Z"
            fill="white"
          />
        </svg>
      </div>

      {#if playingGame}
        <div class="right">
          {#if $muted == true}
            <div class="icon-btn" on:click={handleMute}>
              <Icon width={"1.75rem"} height={"1.75rem"} name={"muted"}></Icon>
            </div>
          {/if}
          {#if $muted == false}
            <div class="icon-btn" on:click={handleMute}>
              <Icon width={"1.75rem"} height={"1.75rem"} name={"unmuted"}
              ></Icon>
            </div>
          {/if}
          <div class="icon-btn" on:click={toggleHelp}>
            <Icon width={"1.75rem"} height={"1.75rem"} name={"help"}></Icon>
          </div>
        </div>
      {/if}
    </div>
    <div class="content">
      {#if splashScreen}
        <div class="splash-screen">
          <button class="styled-btn" on:click={playGame}>PLAY</button>
          <p></p>
          <button class="styled-btn" on:click={toggleHelp}>HOW TO PLAY</button>
          <p></p>
          <button class="styled-btn" on:click={handleCreate}
            >CREATE A SPOTLE</button
          >
          <button class="styled-btn" on:click={playRush}>SPOTLE RUSH</button>

          <p>coming soon</p>
          <button class="styled-btn coming-soon">Spotle Streak</button>

          <p>play our new game!</p>
          <button class="styled-btn purple"
            ><a href="https://harmonies.io" target="_blank">harmonies.io</a
            ></button
          >
        </div>
      {/if}

      {#if playingGame}
        {#if playingRush}
          <Countdown></Countdown>
        {/if}
        <div class="game-container">
          <div class="game-info-container">
            {#if playingRush}
              <div class="solved-spotles">
                Solved Spotles: {rushIndex}
              </div>
            {/if}
            <div class="guesses-remaining">
              {#if normalGame || playingChallenge}
                Guess {guessCount + 1} of 10
              {/if}
              {#if createGame}
                Pick an artist for your friend to guess.
              {/if}
              {#if playingRush}
                Guess {guessCount + 1} of 30
              {/if}
            </div>
          </div>
          {#if showResults && !createGame}
            <Gameover
              {spotleNumber}
              {result}
              artist={mysteryArtistEntry}
              {guessCount}
              {playingChallenge}
              on:close={handleOverlayClose}
              muted={$muted}
            ></Gameover>
          {/if}
          <div class="search-container">
            {#if normalGame}
              <input
                type="text"
                name="search"
                id="search"
                placeholder="Type a guess here..."
                autocomplete="off"
                disabled={$gameOver}
                bind:value={searchTerm}
                on:keydown={(e) => {
                  if (e.key === "Enter")
                    handleSearch(filteredArtists[0], createGame);
                }}
              />
            {:else}
              <input
                type="text"
                name="search"
                id="search"
                placeholder="Type a guess here..."
                autocomplete="off"
                bind:value={searchTerm}
                on:keydown={(e) => {
                  if (e.key === "Enter")
                    handleSearch(filteredArtists[0], createGame);
                }}
              />
            {/if}
            <button
              class="guess-btn"
              on:click={() => handleSearch(filteredArtists[0], createGame)}
              ><i class="fa fa-search fa-lg"></i></button
            >
            <ul
              class="results"
              style="display: {filteredArtists.length > 0 ? 'block' : 'none'}"
            >
              {#each filteredArtists as artist}
                <li on:click={() => handleSearch(artist, createGame)}>
                  {artist}
                </li>
              {/each}
            </ul>
          </div>

          {#if !createGame}
            <div class="guess-container">
              {#if normalGame}
                {#each [...$guesses].reverse() as guess (guess.name)}
                  <Guess artist={guess} {mysteryArtist}></Guess>
                {/each}
              {:else}
                {#each [...tempGuesses].reverse() as guess (guess.name)}
                  <Guess artist={guess} {mysteryArtist}></Guess>
                {/each}
              {/if}
            </div>
          {:else}
            <div>
              <!-- Create Image -->
              {#if createGameSelection}
                <div class="header-row">
                  <img
                    src={createGameSelection.image_uri}
                    alt={createGameSelection.name}
                  />
                  <h2>{createGameSelection.name}</h2>
                </div>

                <p class="challenge-text">Leave a note for your friend.</p>

                <input
                  class="create-form"
                  placeholder="I'm not sure what to write here..."
                  bind:value={createNote}
                />

                <p class="challenge-explain">
                  (this will be visible while guessing)
                </p>
                <button
                  class="styled-btn"
                  on:click={handleCreateShare(createGameSelection)}
                  >{createShareBtnText}</button
                >
              {/if}
            </div>
          {/if}
        </div>
      {/if}
    </div>
    {#if !showHelp}
      <div class="footer">
        <p>made by flatwhite studios</p>
        <p>
          &nbsp;| <a href="./privacy" target="_blank">privacy</a> |
          <a href="https://twitter.com/Spotle_io" target="_blank">follow us!</a>
        </p>
      </div>
    {/if}
  </div>
</body>

<style>
  body {
    scrollbar-width: none; /* For Firefox */
    -ms-overflow-style: none; /* For Internet Explorer and Edge */
  }

  .splash-screen {
    margin-top: 75px;
  }

  .splash-screen p {
    margin-bottom: 3px;
  }

  .splash-screen button:hover {
    transform: scale(1.075) perspective(1px);
  }

  button a {
    color: #fff;
    text-decoration: none; /* no underline */
  }

  .container {
    position: relative;
    width: 100%;
    height: 100vh; /* Set the height of the container to full viewport height */
  }

  .header {
    position: relative; /* Establishes positioning context for absolutely positioned children */
    display: flex;
    align-items: center;
    top: 7%;
    margin-bottom: 25px;
  }

  .logo {
    position: absolute;
    left: 50%; /* Positions the left edge of the element at the center of its containing block */
    transform: translateX(
      -50%
    ); /* Translates the element back by half of its own width, effectively centering it */
  }

  .right {
    margin-left: auto;
    display: flex;
    align-items: center;
    flex-direction: row-reverse;
  }

  .icon-btn {
    margin-left: 7.5px;
  }

  .icon-btn:hover {
    cursor: pointer;
  }

  .left {
    margin-right: 50px;
    display: flex; /* Ensure the button is aligned properly */
    align-items: center; /* Center the button vertically */
  }

  .left button {
    margin: 0; /* Reset margin */
    padding: 0; /* Reset padding */
  }

  button:hover {
    cursor: pointer;
  }

  .smaller-svg svg {
    width: 105%;
    height: 105%;
  }

  .content {
    padding-top: 75px; /* Adjust this value as needed to create space below the logo */
  }

  .styled-btn {
    border-radius: 5px;
    width: 176px;
    height: 52px;
    background-color: #1db954;
    color: #ffff;
    font-weight: bold;
    font-size: 15px;
    position: relative;
    border-radius: 100px;
    margin-bottom: 0.2rem;
    margin-top: 0.2rem;
  }

  .purple {
    background-color: #ba81c2;
  }

  .coming-soon {
    background-color: #c4c4c4;
    color: #808080;
  }

  .game-info-container {
    display: flex;
    justify-content: space-between; /* This will space the items evenly along the main axis */
    width: 100%;
  }

  .solved-spotles {
    color: #fff;
    align-self: flex-start;
  }

  .guesses-remaining {
    color: #ffff;
    align-self: flex-end;
  }

  .search-container {
    position: relative;
    width: 340px;
    border-radius: 1.625rem;
    margin: auto;
    background-color: inherit;
    border: none;
    box-shadow: 0px 1px 5px 3px rgba(0, 0, 0, 0.15);
    display: flex;
    flex-direction: row;
    justify-content: flex-end;
    align-items: center;
  }

  input::value {
    margin-left: 2rem;
  }

  input {
    width: 100%;
    border: none;
    height: 40px;
    border-radius: 1.625rem;
    font-size: 18px;
    box-sizing: border-box;
    padding-left: 1rem;
    box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.1);
  }

  input:focus {
    outline: none;
  }

  button {
    position: absolute;
    border: none;
    background: none;
  }

  button:focus {
    outline: none;
  }

  button i {
    color: #6d7b98;
    cursor: pointer;
  }

  .results {
    position: absolute;
    background-color: #ffff;
    opacity: 90%;
    max-width: 320px;
    width: 100%;
    top: 100%;
    border-radius: 4px;
    z-index: 1;
  }

  .results ul {
    border-radius: 5px;
    padding: 10px 14px;
    transition: all 0.5s linear;
  }

  li {
    list-style: none;
    font-size: 120%;
    margin-top: 2.5px;
    display: flex;
    flex-direction: start;
    justify-content: left;
    color: black;
  }

  li:hover {
    background: #ececec;
  }

  .results {
    padding: 10px;
  }

  .results ul li:hover {
    background: #ececec;
  }

  .guess-container {
    display: flex;
    flex-direction: column;
  }

  .header-row {
    display: flex;
    flex-direction: row; /* Change to row */
    align-items: center; /* Vertically center items */
    color: #fff;
    margin-bottom: 5px;
    margin-top: 30px;
  }

  .header-row img {
    margin-right: 0.8rem;
    border-radius: 50%;
    object-fit: cover;
    width: 80px;
    height: 80px;
  }

  .create-form {
    border-radius: 5px;
  }

  .footer {
    position: fixed;
    margin-top: auto;
    display: flex;
    color: #fff;
    font-size: 12px;
    font-style: normal;
    font-weight: 500;
    line-height: normal;
    bottom: 0;
    width: 100%;
  }

  .footer a {
    color: #6ad074;
    text-decoration: underline;
  }
</style>
