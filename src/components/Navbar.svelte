<script>
  import { createEventDispatcher } from 'svelte';
  import Icon from '../routes/Icon.svelte';
  import { muted } from '../routes/store.js';
  
  // Always show menu button by removing the showBackButton prop
  export let showLogo = true;
  // New props to check if user is in JAM or REWIND mode
  export let playingJam = false;
  export let playingRewind = false;
  
  const dispatch = createEventDispatcher();
  
  function handleMenuClick() {
    dispatch('menu');
  }
  
  function handleMute() {
    $muted = !$muted;
  }
  
  function handleHelpClick() {
    dispatch('help');
  }
  
  function handleStatsClick() {
    dispatch('stats');
  }
</script>

<div class="navbar-container">
<div class="navbar">
  <div class="navbar-left">
    <div class="icon-btn" on:click={handleMenuClick}>
      <Icon width={"1.75rem"} height={"1.75rem"} name={"menu"}></Icon>
    </div>
    
    <!-- Show mode indicator icons based on current game mode -->
    {#if playingJam}
      <div class="mode-indicator jam-mode">
        <svg width="98" height="20" viewBox="0 0 98 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M39.0114 0.0909085H44.071V13.054C44.0649 14.285 43.754 15.3684 43.1385 16.304C42.5291 17.2334 41.6858 17.9598 40.6087 18.483C39.5376 19 38.3035 19.2585 36.9062 19.2585C35.6937 19.2585 34.5857 19.0492 33.5824 18.6307C32.5791 18.206 31.7789 17.5412 31.1818 16.6364C30.5848 15.7254 30.2893 14.5436 30.2955 13.0909H35.429C35.4474 13.5649 35.5275 13.965 35.669 14.2912C35.8168 14.6174 36.0199 14.8636 36.2784 15.0298C36.5431 15.1899 36.8632 15.2699 37.2386 15.2699C37.6203 15.2699 37.9403 15.1868 38.1989 15.0206C38.4635 14.8544 38.6636 14.6082 38.799 14.282C38.9344 13.9496 39.0052 13.5402 39.0114 13.054V0.0909085ZM51.4158 19H45.8761L52.1175 0.0909085H59.1346L65.3761 19H59.8363L55.6999 5.2983H55.5522L51.4158 19ZM50.3817 11.5398H60.7965V15.3807H50.3817V11.5398ZM67.1973 0.0909085H73.5865L77.9814 10.8011H78.2029L82.5978 0.0909085H88.987V19H83.9643V8.06818H83.8166L79.6064 18.8523H76.5779L72.3677 7.99432H72.22V19H67.1973V0.0909085ZM97.4029 0.0909085L96.9228 13.0909H92.7125L92.2324 0.0909085H97.4029ZM94.8176 19.2955C94.1036 19.2955 93.4912 19.0462 92.9803 18.5476C92.4756 18.0429 92.2263 17.4304 92.2324 16.7102C92.2263 16.0085 92.4756 15.4084 92.9803 14.9098C93.4912 14.4112 94.1036 14.1619 94.8176 14.1619C95.4947 14.1619 96.0918 14.4112 96.6088 14.9098C97.132 15.4084 97.3967 16.0085 97.4029 16.7102C97.3967 17.1903 97.2705 17.6274 97.0243 18.0213C96.7843 18.4091 96.4703 18.7199 96.0826 18.9538C95.6948 19.1816 95.2731 19.2955 94.8176 19.2955Z" fill="#CBFF70"/>
          <path d="M16.2848 5.7C15.9579 6.27736 15.7858 6.93277 15.7858 7.6C15.7858 8.26723 15.9579 8.92264 16.2848 9.5H9.71518C10.0421 8.92264 10.2142 8.26723 10.2142 7.6C10.2142 6.93277 10.0421 6.27736 9.71518 5.7H16.2848ZM6.5 5.7C6.13269 5.7 5.77363 5.81143 5.46823 6.02021C5.16282 6.22898 4.92479 6.52572 4.78422 6.8729C4.64366 7.22008 4.60688 7.60211 4.67854 7.97067C4.7502 8.33924 4.92708 8.67778 5.1868 8.9435C5.44653 9.20922 5.77744 9.39018 6.13769 9.46349C6.49794 9.5368 6.87135 9.49918 7.2107 9.35537C7.55005 9.21157 7.84009 8.96804 8.04416 8.65558C8.24822 8.34313 8.35714 7.97578 8.35714 7.6C8.35714 7.09609 8.16148 6.61282 7.8132 6.2565C7.46492 5.90018 6.99254 5.7 6.5 5.7ZM26 1.9V17.1C26 17.6039 25.8043 18.0872 25.4561 18.4435C25.1078 18.7998 24.6354 19 24.1429 19H1.85714C1.3646 19 0.892226 18.7998 0.543944 18.4435C0.195663 18.0872 0 17.6039 0 17.1V1.9C0 1.39609 0.195663 0.912816 0.543944 0.556497C0.892226 0.200178 1.3646 0 1.85714 0H24.1429C24.6354 0 25.1078 0.200178 25.4561 0.556497C25.8043 0.912816 26 1.39609 26 1.9ZM19.7321 17.1L17.9214 14.63C17.8349 14.512 17.7228 14.4163 17.5938 14.3503C17.4649 14.2843 17.3227 14.25 17.1786 14.25H8.82143C8.67727 14.25 8.5351 14.2843 8.40616 14.3503C8.27722 14.4163 8.16506 14.512 8.07857 14.63L6.26786 17.1H19.7321ZM23.2143 7.6C23.2143 6.59218 22.823 5.62563 22.1264 4.91299C21.4298 4.20036 20.4851 3.8 19.5 3.8H6.5C5.51491 3.8 4.57017 4.20036 3.8736 4.91299C3.17704 5.62563 2.78571 6.59218 2.78571 7.6C2.78571 8.60782 3.17704 9.57437 3.8736 10.287C4.57017 10.9996 5.51491 11.4 6.5 11.4H19.5C20.4851 11.4 21.4298 10.9996 22.1264 10.287C22.823 9.57437 23.2143 8.60782 23.2143 7.6ZM19.5 5.7C19.1327 5.7 18.7736 5.81143 18.4682 6.02021C18.1628 6.22898 17.9248 6.52572 17.7842 6.8729C17.6437 7.22008 17.6069 7.60211 17.6785 7.97067C17.7502 8.33924 17.9271 8.67778 18.1868 8.9435C18.4465 9.20922 18.7774 9.39018 19.1377 9.46349C19.4979 9.5368 19.8713 9.49918 20.2107 9.35537C20.55 9.21157 20.8401 8.96804 21.0442 8.65558C21.2482 8.34313 21.3571 7.97578 21.3571 7.6C21.3571 7.09609 21.1615 6.61282 20.8132 6.2565C20.4649 5.90018 19.9925 5.7 19.5 5.7Z" fill="#CBFF70"/>
        </svg>
      </div>
    {/if}
    
    {#if playingRewind}
      <div class="mode-indicator rewind-mode">
        <svg width="130" height="31" viewBox="0 0 130 31" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M23.2188 25V6.09091H31.3807C32.7841 6.09091 34.0121 6.34635 35.0646 6.85724C36.1172 7.36813 36.9358 8.10369 37.5206 9.06392C38.1054 10.0241 38.3977 11.1752 38.3977 12.517C38.3977 13.8712 38.0961 15.013 37.4929 15.9425C36.8958 16.8719 36.0556 17.5736 34.9723 18.0476C33.8951 18.5215 32.6364 18.7585 31.196 18.7585H26.321V14.7699H30.1619C30.7652 14.7699 31.2791 14.696 31.7038 14.5483C32.1347 14.3944 32.464 14.1513 32.6918 13.8189C32.9257 13.4865 33.0426 13.0526 33.0426 12.517C33.0426 11.9754 32.9257 11.5353 32.6918 11.1967C32.464 10.852 32.1347 10.5997 31.7038 10.4396C31.2791 10.2734 30.7652 10.1903 30.1619 10.1903H28.3523V25H23.2188ZM34.2983 16.321L39.0256 25H33.4489L28.8324 16.321H34.2983ZM40.5859 25V6.09091H54.2138V10.2273H45.7195V13.4773H53.5121V17.6136H45.7195V20.8636H54.1768V25H40.5859ZM61.5609 25L55.9842 6.09091H61.7086L64.2939 17.7244H64.4416L67.5069 6.09091H72.0126L75.0779 17.7614H75.2257L77.8109 6.09091H83.5353L77.9586 25H73.0467L69.8336 14.4375H69.6859L66.4728 25H61.5609ZM90.3308 6.09091V25H85.1973V6.09091H90.3308ZM109.124 6.09091V25H104.84L98.008 15.0653H97.8972V25H92.7637V6.09091H97.1216L103.843 15.9886H103.991V6.09091H109.124ZM118.828 25H111.553V6.09091H118.754C120.7 6.09091 122.38 6.46946 123.796 7.22656C125.218 7.97751 126.313 9.06084 127.083 10.4766C127.858 11.8861 128.246 13.5758 128.246 15.5455C128.246 17.5152 127.861 19.2079 127.092 20.6236C126.322 22.0331 125.233 23.1165 123.823 23.8736C122.414 24.6245 120.749 25 118.828 25ZM116.686 20.642H118.644C119.579 20.642 120.376 20.4912 121.035 20.1896C121.7 19.888 122.204 19.3679 122.549 18.6293C122.9 17.8906 123.075 16.8627 123.075 15.5455C123.075 14.2282 122.897 13.2003 122.54 12.4616C122.189 11.723 121.672 11.2029 120.989 10.9013C120.312 10.5997 119.481 10.4489 118.496 10.4489H116.686V20.642Z" fill="#CBFF70"/>
          <path d="M10.7401 14.0024L19.2805 7.09408C19.3502 7.03779 19.4312 7.0055 19.5149 7.00064C19.5985 6.99579 19.6817 7.01855 19.7555 7.06651C19.8294 7.11447 19.8911 7.18583 19.9342 7.27299C19.9772 7.36015 20 7.45984 20 7.56145V23.4385C20 23.5402 19.9772 23.6399 19.9342 23.727C19.8911 23.8142 19.8294 23.8855 19.7555 23.9335C19.6817 23.9814 19.5985 24.0042 19.5149 23.9994C19.4312 23.9945 19.3502 23.9622 19.2805 23.9059L10.7401 16.9976V23.4385C10.7401 23.5402 10.7173 23.6399 10.6743 23.727C10.6312 23.8142 10.5695 23.8855 10.4957 23.9335C10.4219 23.9814 10.3387 24.0042 10.255 23.9994C10.1714 23.9945 10.0904 23.9622 10.0207 23.9059L0.206136 15.9674C0.142725 15.9161 0.0907332 15.8466 0.0547739 15.765C0.0188146 15.6835 0 15.5925 0 15.5C0 15.4075 0.0188146 15.3165 0.0547739 15.235C0.0907332 15.1534 0.142725 15.0839 0.206136 15.0326L10.0207 7.09408C10.0904 7.03779 10.1714 7.0055 10.255 7.00064C10.3387 6.99579 10.4219 7.01855 10.4957 7.06651C10.5695 7.11447 10.6312 7.18583 10.6743 7.27299C10.7173 7.36015 10.7401 7.45984 10.7401 7.56145V14.0024Z" fill="#CBFF70"/>
        </svg>
      </div>
    {/if}
  </div>
  
  {#if false}
    <div class="navbar-logo">
      <svg
        width="120"
        height="44"
        viewBox="0 0 922 322"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <!-- SVG content omitted for brevity -->
      </svg>
    </div>
  {/if}
  
  <div class="navbar-right">
    <div class="icon-btn" on:click={handleStatsClick}>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2 12H6V21H2V12Z" fill="white"/>
        <path d="M10 8H14V21H10V8Z" fill="white"/>
        <path d="M18 3H22V21H18V3Z" fill="white"/>
      </svg>
    </div>
    {#if $muted}
      <div class="icon-btn" on:click={handleMute}>
        <Icon width={"1.75rem"} height={"1.75rem"} name={"muted"}></Icon>
      </div>
    {:else}
      <div class="icon-btn" on:click={handleMute}>
        <Icon width={"1.75rem"} height={"1.75rem"} name={"unmuted"}></Icon>
      </div>
    {/if}
    <div class="icon-btn" on:click={handleHelpClick}>
      <Icon width={"1.75rem"} height={"1.75rem"} name={"help"}></Icon>
    </div>
  </div>
</div>
</div>

<style>
.navbar-container {
  position: sticky;
  top: 50px; /* Leave space for the ad above */
  width: 100%;
  height: 50px;
  background-color: #121212;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  z-index: 100;
  margin-bottom: 15px; /* Add bottom margin for spacing */
}

.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  max-width: 100%;
  height: 100%;
  padding: 0 15px;
}

.navbar-left, .navbar-right {
  display: flex;
  align-items: center;
}

/* Added styles for navbar-left to properly align the mode indicators */
.navbar-left {
  gap: 12px; /* Add spacing between menu button and mode indicator */
}

.navbar-logo {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  justify-content: center;
  align-items: center;
}

.icon-btn {
  margin: 0 7.5px;
  cursor: pointer;
}

.navbar-right {
  display: flex;
  justify-content: flex-end;
}

/* New styles for mode indicators */
/* .mode-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
} */

/* Desktop styles */
@media (min-width: 768px) {
  .navbar {
    max-width: 800px;
    margin: 0 auto;
  }
}
</style>